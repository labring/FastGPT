<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIæµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background: #45a049;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            background: #f4f4f4;
            border-radius: 4px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .error {
            background: #ffebee;
            color: #c62828;
        }
        .success {
            background: #e8f5e9;
            color: #2e7d32;
        }
    </style>
</head>
<body>
    <h1>ğŸ” åç«¯APIè¿æ¥æµ‹è¯•</h1>
    <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•å‰ç«¯æ˜¯å¦èƒ½è¿æ¥åˆ°åç«¯API</p>
    
    <div>
        <button onclick="testFeedbackAPI()">æµ‹è¯•åé¦ˆAPI</button>
        <button onclick="testAnnouncementAPI()">æµ‹è¯•å…¬å‘ŠAPI</button>
        <button onclick="testBoth()">æµ‹è¯•ä¸¤ä¸ªAPI</button>
    </div>
    
    <div id="result"></div>
    
    <script>
        const resultDiv = document.getElementById('result');
        
        function showResult(message, isError = false) {
            resultDiv.textContent = message;
            resultDiv.className = isError ? 'error' : 'success';
        }
        
        async function testFeedbackAPI() {
            showResult('æ­£åœ¨æµ‹è¯•åé¦ˆAPI...');
            try {
                const apiUrl = window.location.hostname === 'localhost' 
                    ? 'http://localhost:8080/api/feedbacks/all'
                    : 'http://10.14.53.120:8080/api/feedbacks/all';
                console.log('å¼€å§‹è¯·æ±‚åé¦ˆAPI...', apiUrl);
                const response = await fetch(apiUrl, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log('å“åº”çŠ¶æ€:', response.status);
                const data = await response.json();
                console.log('å“åº”æ•°æ®:', data);
                
                showResult(
                    `âœ… åé¦ˆAPIæµ‹è¯•æˆåŠŸï¼\n\n` +
                    `çŠ¶æ€ç : ${response.status}\n` +
                    `å“åº”æ•°æ®:\n${JSON.stringify(data, null, 2)}`
                );
            } catch (error) {
                console.error('åé¦ˆAPIæµ‹è¯•å¤±è´¥:', error);
                showResult(
                    `âŒ åé¦ˆAPIæµ‹è¯•å¤±è´¥ï¼\n\n` +
                    `é”™è¯¯: ${error.message}\n\n` +
                    `å¯èƒ½åŸå› :\n` +
                    `1. åç«¯æœåŠ¡æœªå¯åŠ¨\n` +
                    `2. ç«¯å£8080è¢«å…¶ä»–ç¨‹åºå ç”¨\n` +
                    `3. CORSè·¨åŸŸé—®é¢˜`,
                    true
                );
            }
        }
        
        async function testAnnouncementAPI() {
            showResult('æ­£åœ¨æµ‹è¯•å…¬å‘ŠAPI...');
            try {
                console.log('å¼€å§‹è¯·æ±‚å…¬å‘ŠAPI...');
                const requestData = {
                    adminUserId: 1,
                    title: 'æµè§ˆå™¨æµ‹è¯•å…¬å‘Š',
                    content: 'è¿™æ˜¯ä»æµ‹è¯•é¡µé¢å‘é€çš„å…¬å‘Š',
                    priority: 0
                };
                
                const apiUrl = window.location.hostname === 'localhost'
                    ? 'http://localhost:8080/api/announcements/create'
                    : 'http://10.14.53.120:8080/api/announcements/create';
                
                console.log('è¯·æ±‚æ•°æ®:', requestData);
                console.log('APIåœ°å€:', apiUrl);
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData)
                });
                
                console.log('å“åº”çŠ¶æ€:', response.status);
                const data = await response.json();
                console.log('å“åº”æ•°æ®:', data);
                
                showResult(
                    `âœ… å…¬å‘ŠAPIæµ‹è¯•æˆåŠŸï¼\n\n` +
                    `çŠ¶æ€ç : ${response.status}\n` +
                    `å“åº”æ•°æ®:\n${JSON.stringify(data, null, 2)}`
                );
            } catch (error) {
                console.error('å…¬å‘ŠAPIæµ‹è¯•å¤±è´¥:', error);
                showResult(
                    `âŒ å…¬å‘ŠAPIæµ‹è¯•å¤±è´¥ï¼\n\n` +
                    `é”™è¯¯: ${error.message}\n\n` +
                    `å¯èƒ½åŸå› :\n` +
                    `1. åç«¯æœåŠ¡æœªå¯åŠ¨\n` +
                    `2. ç«¯å£8080è¢«å…¶ä»–ç¨‹åºå ç”¨\n` +
                    `3. CORSè·¨åŸŸé—®é¢˜`,
                    true
                );
            }
        }
        
        async function testBoth() {
            await testFeedbackAPI();
            setTimeout(testAnnouncementAPI, 2000);
        }
    </script>
</body>
</html>
