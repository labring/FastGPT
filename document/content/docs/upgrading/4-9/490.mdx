---
title: V4.9.0(åŒ…å«å‡çº§è„šæœ¬)
description: FastGPT V4.9.0 æ›´æ–°è¯´æ˜
---

## æ›´æ–°æŒ‡å—

### 1. åšå¥½æ•°æ®åº“å¤‡ä»½

### 2. æ›´æ–°é•œåƒå’Œ PG å®¹å™¨

- æ›´æ–° FastGPT é•œåƒ tag: v4.9.0
- æ›´æ–° FastGPT å•†ä¸šç‰ˆé•œåƒ tag: v4.9.0
- Sandbox é•œåƒï¼Œå¯ä»¥ä¸æ›´æ–°
- æ›´æ–° PG å®¹å™¨ä¸º v0.8.0-pg15, å¯ä»¥æŸ¥çœ‹[æœ€æ–°çš„ yml](https://raw.githubusercontent.com/labring/FastGPT/main/deploy/docker/docker-compose-pgvector.yml)

### 3. æ›¿æ¢ OneAPIï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ä½¿ç”¨ [AI Proxy](https://github.com/labring/aiproxy) æ›¿æ¢ OneAPI çš„ç”¨æˆ·å¯æ‰§è¡Œè¯¥æ­¥éª¤ã€‚

#### 1. ä¿®æ”¹ yml æ–‡ä»¶

å‚è€ƒ[æœ€æ–°çš„ yml](https://raw.githubusercontent.com/labring/FastGPT/main/deploy/docker/docker-compose-pgvector.yml) æ–‡ä»¶ã€‚é‡Œé¢å·²ç§»é™¤ OneAPI å¹¶æ·»åŠ äº† AIProxyé…ç½®ã€‚åŒ…å«ä¸€ä¸ªæœåŠ¡å’Œä¸€ä¸ª PgSQL æ•°æ®åº“ã€‚å°† `aiproxy` çš„é…ç½®`è¿½åŠ `åˆ° OneAPI çš„é…ç½®åé¢ï¼ˆå…ˆä¸è¦åˆ é™¤ OneAPIï¼Œæœ‰ä¸€ä¸ªåˆå§‹åŒ–ä¼šè‡ªåŠ¨åŒæ­¥ OneAPI çš„é…ç½®ï¼‰

<details>
<summary>AI Proxy Yml é…ç½®</summary>

```
  # AI Proxy
  aiproxy:
    image: 'ghcr.io/labring/aiproxy:latest'
    container_name: aiproxy
    restart: unless-stopped
    depends_on:
      aiproxy_pg:
        condition: service_healthy
    networks:
      - fastgpt
    environment:
      # å¯¹åº” fastgpt é‡Œçš„AIPROXY_API_TOKEN
      - ADMIN_KEY=aiproxy
      # é”™è¯¯æ—¥å¿—è¯¦æƒ…ä¿å­˜æ—¶é—´ï¼ˆå°æ—¶ï¼‰
      - LOG_DETAIL_STORAGE_HOURS=1
      # æ•°æ®åº“è¿æ¥åœ°å€
      - SQL_DSN=postgres://postgres:aiproxy@aiproxy_pg:5432/aiproxy
      # æœ€å¤§é‡è¯•æ¬¡æ•°
      - RETRY_TIMES=3
      # ä¸éœ€è¦è®¡è´¹
      - BILLING_ENABLED=false
      # ä¸éœ€è¦ä¸¥æ ¼æ£€æµ‹æ¨¡å‹
      - DISABLE_MODEL_CONFIG=true
    healthcheck:
      test: ['CMD', 'curl', '-f', 'http://localhost:3000/api/status']
      interval: 5s
      timeout: 5s
      retries: 10
  aiproxy_pg:
    image: pgvector/pgvector:0.8.0-pg15 # docker hub
    # image: registry.cn-hangzhou.aliyuncs.com/fastgpt/pgvector:v0.8.0-pg15 # é˜¿é‡Œäº‘
    restart: unless-stopped
    container_name: aiproxy_pg
    volumes:
      - ./aiproxy_pg:/var/lib/postgresql/data
    networks:
      - fastgpt
    environment:
      TZ: Asia/Shanghai
      POSTGRES_USER: postgres
      POSTGRES_DB: aiproxy
      POSTGRES_PASSWORD: aiproxy
    healthcheck:
      test: ['CMD', 'pg_isready', '-U', 'postgres', '-d', 'aiproxy']
      interval: 5s
      timeout: 5s
      retries: 10
```

</details>

#### 2. å¢åŠ  FastGPT ç¯å¢ƒå˜é‡ï¼š

ä¿®æ”¹ yml æ–‡ä»¶ä¸­ï¼Œfastgpt å®¹å™¨çš„ç¯å¢ƒå˜é‡ï¼š

```
# AI Proxy çš„åœ°å€ï¼Œå¦‚æœé…äº†è¯¥åœ°å€ï¼Œä¼˜å…ˆä½¿ç”¨
- AIPROXY_API_ENDPOINT=http://aiproxy:3000
# AI Proxy çš„ Admin Tokenï¼Œä¸ AI Proxy ä¸­çš„ç¯å¢ƒå˜é‡ ADMIN_KEY
- AIPROXY_API_TOKEN=aiproxy
```

#### 3. é‡è½½æœåŠ¡

`docker-compose down` åœæ­¢æœåŠ¡ï¼Œç„¶å `docker-compose up -d` å¯åŠ¨æœåŠ¡ï¼Œæ­¤æ—¶ä¼šè¿½åŠ  `aiproxy` æœåŠ¡ï¼Œå¹¶ä¿®æ”¹ FastGPT çš„é…ç½®ã€‚

#### 4. æ‰§è¡ŒOneAPIè¿ç§»AI proxyè„šæœ¬

- å¯è”ç½‘æ–¹æ¡ˆ:

```bash
# è¿›å…¥ aiproxy å®¹å™¨
docker exec -it aiproxy sh
# å®‰è£… curl
apk add curl
# æ‰§è¡Œè„šæœ¬
curl --location --request POST 'http://localhost:3000/api/channels/import/oneapi' \
--header 'Authorization: Bearer aiproxy' \
--header 'Content-Type: application/json' \
--data-raw '{
    "dsn": "mysql://root:oneapimmysql@tcp(mysql:3306)/oneapi"
}'
# è¿”å› {"data":[],"success":true} ä»£è¡¨æˆåŠŸ
```

- æ— æ³•è”ç½‘æ—¶ï¼Œå¯æ‰“å¼€`aiproxy`çš„å¤–ç½‘æš´éœ²ç«¯å£ï¼Œç„¶ååœ¨æœ¬åœ°æ‰§è¡Œè„šæœ¬ã€‚

aiProxy æš´éœ²ç«¯å£ï¼š3003:3000ï¼Œä¿®æ”¹åé‡æ–° `docker-compose up -d` å¯åŠ¨æœåŠ¡ã€‚

```bash
# åœ¨ç»ˆç«¯æ‰§è¡Œè„šæœ¬
curl --location --request POST 'http://localhost:3003/api/channels/import/oneapi' \
--header 'Authorization: Bearer aiproxy' \
--header 'Content-Type: application/json' \
--data-raw '{
    "dsn": "mysql://root:oneapimmysql@tcp(mysql:3306)/oneapi"
}'
# è¿”å› {"data":[],"success":true} ä»£è¡¨æˆåŠŸ
```

- å¦‚æœä¸ç†Ÿæ‚‰ docker æ“ä½œï¼Œå»ºè®®ä¸è¦èµ°è„šæœ¬è¿ç§»ï¼Œç›´æ¥åˆ é™¤ OneAPI æ‰€æœ‰å†…å®¹ï¼Œç„¶åæ‰‹åŠ¨é‡æ–°æ·»åŠ æ¸ é“ã€‚

#### 5. è¿›å…¥ FastGPT æ£€æŸ¥`AI Proxy` æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨ã€‚

ç™»å½• root è´¦å·åï¼Œåœ¨`è´¦å·-æ¨¡å‹æä¾›å•†`é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°å¤šå‡ºäº†`æ¨¡å‹æ¸ é“`å’Œ`è°ƒç”¨æ—¥å¿—`ä¸¤ä¸ªé€‰é¡¹ï¼Œæ‰“å¼€æ¨¡å‹æ¸ é“ï¼Œå¯ä»¥çœ‹åˆ°ä¹‹å‰ OneAPI çš„æ¸ é“ï¼Œè¯´æ˜è¿ç§»å®Œæˆï¼Œæ­¤æ—¶å¯ä»¥æ‰‹åŠ¨å†æ£€æŸ¥ä¸‹æ¸ é“æ˜¯å¦æ­£å¸¸ã€‚

#### 6. åˆ é™¤ OneAPI æœåŠ¡

```bash
# åœæ­¢æœåŠ¡ï¼Œæˆ–è€…é’ˆå¯¹æ€§åœæ­¢ OneAPI å’Œå…¶ Mysql
docker-compose down
# yml æ–‡ä»¶ä¸­åˆ é™¤ OneAPI å’Œå…¶ Mysql ä¾èµ–
# é‡å¯æœåŠ¡
docker-compose up -d
```

### 4. è¿è¡Œ FastGPT å‡çº§è„šæœ¬

ä»ä»»æ„ç»ˆç«¯ï¼Œå‘èµ· 1 ä¸ª HTTP è¯·æ±‚ã€‚å…¶ä¸­ `{{rootkey}}` æ›¿æ¢æˆç¯å¢ƒå˜é‡é‡Œçš„ `rootkey`ï¼›`{{host}}` æ›¿æ¢æˆ**FastGPT åŸŸå**ã€‚

```bash
curl --location --request POST 'https://{{host}}/api/admin/initv490' \
--header 'rootkey: {{rootkey}}' \
--header 'Content-Type: application/json'
```

**è„šæœ¬åŠŸèƒ½**

1. å‡çº§ PG Vector æ’ä»¶ç‰ˆæœ¬
2. å…¨é‡æ›´æ–°çŸ¥è¯†åº“é›†åˆå­—æ®µã€‚
3. å…¨é‡æ›´æ–°çŸ¥è¯†åº“æ•°æ®ä¸­ï¼Œindex çš„ type ç±»å‹ã€‚ï¼ˆæ—¶é—´è¾ƒé•¿ï¼Œæœ€åå¯èƒ½æç¤º timeoutï¼Œå¯å¿½ç•¥ï¼Œæ•°æ®åº“ä¸å´©éƒ½ä¼šä¸€ç›´å¢é‡æ‰§è¡Œï¼‰

## å…¼å®¹ & å¼ƒç”¨

1. å¼ƒç”¨ - ä¹‹å‰ç§æœ‰åŒ–éƒ¨ç½²çš„è‡ªå®šä¹‰æ–‡ä»¶è§£ææ–¹æ¡ˆï¼Œè¯·åŒæ­¥æ›´æ–°åˆ°æœ€æ–°çš„é…ç½®æ–¹æ¡ˆã€‚[ç‚¹å‡»æŸ¥çœ‹ PDF å¢å¼ºè§£æé…ç½®](/docs/introduction/development/configuration/#ä½¿ç”¨-doc2x-è§£æ-pdf-æ–‡ä»¶)
2. å¼ƒç”¨ - å¼ƒç”¨æ—§ç‰ˆæœ¬åœ°æ–‡ä»¶ä¸Šä¼  APIï¼š/api/core/dataset/collection/create/fileï¼ˆä»¥å‰ä»…å•†ä¸šç‰ˆå¯ç”¨çš„ APIï¼Œè¯¥æ¥å£å·²æ”¾åˆ‡æ¢æˆï¼š/api/core/dataset/collection/create/localFileï¼‰
3. åœæ­¢ç»´æŠ¤ï¼Œå³å°†å¼ƒç”¨ - å¤–éƒ¨æ–‡ä»¶åº“ç›¸å…³ APIï¼Œå¯é€šè¿‡ API æ–‡ä»¶åº“æ›¿ä»£ã€‚
4. APIæ›´æ–° - ä¸Šä¼ æ–‡ä»¶è‡³çŸ¥è¯†åº“ã€åˆ›å»ºè¿æ¥é›†åˆã€API æ–‡ä»¶åº“ã€æ¨é€åˆ†å—æ•°æ®ç­‰å¸¦æœ‰ `trainingType` å­—æ®µçš„æ¥å£ï¼Œ`trainingType`å­—æ®µæœªæ¥ä»…æ”¯æŒ`chunk`å’Œ`QA`ä¸¤ç§æ¨¡å¼ã€‚å¢å¼ºç´¢å¼•æ¨¡å¼å°†è®¾ç½®å•ç‹¬å­—æ®µï¼š`autoIndexes`ï¼Œç›®å‰ä»æœ‰é€‚é…æ—§ç‰ˆ`trainingType=auto`ä»£ç ï¼Œä½†è¯·å°½å¿«å˜æ›´æˆæ–°æ¥å£ç±»å‹ã€‚å…·ä½“å¯è§ï¼š[çŸ¥è¯†åº“ OpenAPI æ–‡æ¡£](/docs/introduction/development/openapi/dataset.md)

## ğŸš€ æ–°å¢å†…å®¹

1. PDFå¢å¼ºè§£æäº¤äº’æ·»åŠ åˆ°é¡µé¢ä¸Šã€‚åŒæ—¶å†…åµŒ Doc2x æœåŠ¡ï¼Œå¯ç›´æ¥ä½¿ç”¨ Doc2x æœåŠ¡è§£æ PDF æ–‡ä»¶ã€‚
2. å›¾ç‰‡è‡ªåŠ¨æ ‡æ³¨ï¼ŒåŒæ—¶ä¿®æ”¹çŸ¥è¯†åº“æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†æ•°æ®é€»è¾‘å’Œäº¤äº’ã€‚
3. pg vector æ’ä»¶å‡çº§ 0.8.0 ç‰ˆæœ¬ï¼Œå¼•å…¥è¿­ä»£æœç´¢ï¼Œå‡å°‘éƒ¨åˆ†æ•°æ®æ— æ³•è¢«æ£€ç´¢çš„æƒ…å†µã€‚
4. æ–°å¢ qwen-qwq ç³»åˆ—æ¨¡å‹é…ç½®ã€‚

## âš™ï¸ ä¼˜åŒ–

1. çŸ¥è¯†åº“æ•°æ®ä¸å†é™åˆ¶ç´¢å¼•æ•°é‡ï¼Œå¯æ— é™è‡ªå®šä¹‰ã€‚åŒæ—¶å¯è‡ªåŠ¨æ›´æ–°è¾“å…¥æ–‡æœ¬çš„ç´¢å¼•ï¼Œä¸å½±å“è‡ªå®šä¹‰ç´¢å¼•ã€‚
2. Markdown è§£æï¼Œå¢åŠ é“¾æ¥åä¸­æ–‡æ ‡ç‚¹ç¬¦å·æ£€æµ‹ï¼Œå¢åŠ ç©ºæ ¼ã€‚
3. Prompt æ¨¡å¼å·¥å…·è°ƒç”¨ï¼Œæ”¯æŒæ€è€ƒæ¨¡å‹ã€‚åŒæ—¶ä¼˜åŒ–å…¶æ ¼å¼æ£€æµ‹ï¼Œå‡å°‘ç©ºè¾“å‡ºçš„æ¦‚ç‡ã€‚
4. Mongo æ–‡ä»¶è¯»å–æµåˆå¹¶ï¼Œå‡å°‘è®¡ç®—é‡ã€‚åŒæ—¶ä¼˜åŒ–å­˜å‚¨ chunksï¼Œæå¤§æé«˜å¤§æ–‡ä»¶è¯»å–é€Ÿåº¦ã€‚50M PDF è¯»å–æ—¶é—´æé«˜ 3 å€ã€‚
5. HTTP Body é€‚é…ï¼Œå¢åŠ å¯¹å­—ç¬¦ä¸²å¯¹è±¡çš„é€‚é…ã€‚

## ğŸ› ä¿®å¤

1. å¢åŠ ç½‘é¡µæŠ“å–å®‰å…¨é“¾æ¥æ ¡éªŒã€‚
2. æ‰¹é‡è¿è¡Œæ—¶ï¼Œå…¨å±€å˜é‡æœªè¿›ä¸€æ­¥ä¼ é€’åˆ°ä¸‹ä¸€æ¬¡è¿è¡Œä¸­ï¼Œå¯¼è‡´æœ€ç»ˆå˜é‡æ›´æ–°é”™è¯¯ã€‚
