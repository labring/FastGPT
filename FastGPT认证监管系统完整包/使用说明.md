# FastGPT è®¤è¯ç›‘ç®¡ç³»ç»Ÿ - ä½¿ç”¨è¯´æ˜

## ğŸ“‹ å‰ç½®è¦æ±‚

### ç¯å¢ƒè¦æ±‚
- Node.js 14.0+ 
- åŸå§‹ FastGPT å·²åœ¨ç«¯å£ 3000 è¿è¡Œ
- å¯ç”¨ç«¯å£: 3001, 3002

### FastGPT è¿è¡Œç¡®è®¤
ç¡®ä¿æ‚¨çš„ FastGPT èƒ½å¤Ÿæ­£å¸¸è®¿é—®ï¼š
```bash
# æµ‹è¯• FastGPT æ˜¯å¦æ­£å¸¸è¿è¡Œ
curl http://localhost:3000
# æˆ–åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3000
```

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### ç¬¬ä¸€æ­¥: å®‰è£…ä¾èµ–
```bash
# åœ¨é¡¹ç›®ç›®å½•ä¸‹å®‰è£…ä¾èµ–
npm install express cors
```

### ç¬¬äºŒæ­¥: å¯åŠ¨ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ
```bash
# å¯åŠ¨ç”¨æˆ·ç®¡ç†å’Œè®¤è¯æœåŠ¡
node simple-server.js
```
**é¢„æœŸè¾“å‡º:**
```
ğŸš€ ç”¨æˆ·ç®¡ç†ç³»ç»Ÿå¯åŠ¨æˆåŠŸï¼
ğŸ“ æœåŠ¡åœ°å€: http://localhost:3002
ğŸ” é»˜è®¤ç®¡ç†å‘˜: admin / 123456
ğŸ“Š APIæ–‡æ¡£: http://localhost:3002/api
```

### ç¬¬ä¸‰æ­¥: å¯åŠ¨è®¤è¯ä»£ç†æœåŠ¡å™¨
```bash
# å¯åŠ¨è®¤è¯ä»£ç†ï¼ˆæ–°å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼‰
node fixed-proxy.js
```
**é¢„æœŸè¾“å‡º:**
```
ğŸ” FastGPTè®¤è¯ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼
ğŸ“ ä»£ç†åœ°å€: http://localhost:3001
ğŸ¯ FastGPTåœ°å€: http://localhost:3000
âš¡ æ‰€æœ‰åˆ†äº«é“¾æ¥ç°åœ¨éœ€è¦è®¤è¯è®¿é—®
```

### ç¬¬å››æ­¥: ç³»ç»Ÿæµ‹è¯•
1. æ‰“å¼€æµè§ˆå™¨è®¿é—®: `è®¤è¯ä»£ç†.html`
2. ç‚¹å‡»"æ£€æŸ¥è®¤è¯çŠ¶æ€"
3. å¦‚æœæœªç™»å½•ï¼Œç‚¹å‡»"æµ‹è¯•ç™»å½•"è¿›è¡Œç™»å½•
4. ç™»å½•åç‚¹å‡»"ä»£ç†è®¿é—®åˆ†äº«é“¾æ¥"æµ‹è¯•å®Œæ•´æµç¨‹

## ğŸ”§ è¯¦ç»†é…ç½®

### ç”¨æˆ·ç®¡ç†ç³»ç»Ÿé…ç½® (simple-server.js)

#### ç«¯å£é…ç½®
```javascript
const PORT = 3002; // å¯ä¿®æ”¹ä¸ºå…¶ä»–ç«¯å£
```

#### é»˜è®¤ç”¨æˆ·
```javascript
let users = [
    { id: 1, username: 'admin', email: 'admin@test.com', password: '123456', role: 'admin' },
    { id: 2, username: 'user1', email: 'user1@test.com', password: '123456', role: 'user' }
];
```

#### JWT Token é…ç½®
```javascript
// Token è¿‡æœŸæ—¶é—´é…ç½®
const tokenExpiry = 24 * 60 * 60 * 1000; // 24å°æ—¶
```

### è®¤è¯ä»£ç†é…ç½® (fixed-proxy.js)

#### ç«¯å£é…ç½®
```javascript
const PROXY_PORT = 3001;     // ä»£ç†æœåŠ¡ç«¯å£
const FASTGPT_PORT = 3000;   // FastGPT ç«¯å£
const USER_SYSTEM_PORT = 3002; // ç”¨æˆ·ç®¡ç†ç³»ç»Ÿç«¯å£
```

#### è„šæœ¬æ³¨å…¥æ§åˆ¶
```javascript
// æ§åˆ¶æ˜¯å¦æ³¨å…¥ç›‘æ§è„šæœ¬
const ENABLE_SCRIPT_INJECTION = true; // è®¾ä¸º false ç¦ç”¨è„šæœ¬æ³¨å…¥
```

## ğŸ“± ä½¿ç”¨æµç¨‹

### æ™®é€šç”¨æˆ·ä½¿ç”¨æµç¨‹

1. **è®¿é—®åˆ†äº«é“¾æ¥**
   ```
   åŸæ¥: http://localhost:3000/chat/share?shareId=xxxxx
   ç°åœ¨: http://localhost:3001/chat/share?shareId=xxxxx
   ```

2. **è‡ªåŠ¨è·³è½¬ç™»å½•**
   - å¦‚æœæœªç™»å½•ï¼Œç³»ç»Ÿè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢
   - è¾“å…¥ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•

3. **è®¤è¯åè®¿é—®**
   - ç™»å½•æˆåŠŸåè‡ªåŠ¨è·³è½¬å›åŸåˆ†äº«é“¾æ¥
   - å¯æ­£å¸¸ä½¿ç”¨ FastGPT çš„æ‰€æœ‰åŠŸèƒ½
   - èŠå¤©è¡Œä¸ºä¼šè¢«è‡ªåŠ¨è®°å½•

### ç®¡ç†å‘˜ä½¿ç”¨æµç¨‹

1. **è®¿é—®ç®¡ç†åå°**
   ```
   http://localhost:3002/admin.html
   ```

2. **æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨**
   - æ‰€æœ‰æ³¨å†Œç”¨æˆ·ä¿¡æ¯
   - ç”¨æˆ·è§’è‰²å’ŒçŠ¶æ€

3. **æŸ¥çœ‹èŠå¤©è®°å½•**
   - ç”¨æˆ·èŠå¤©å†å²
   - è®¿é—®æ—¶é—´ç»Ÿè®¡
   - è¡Œä¸ºåˆ†ææ•°æ®

## ğŸ” API æ¥å£æ–‡æ¡£

### ç”¨æˆ·è®¤è¯æ¥å£

#### ç”¨æˆ·æ³¨å†Œ
```http
POST /api/user/register
Content-Type: application/json

{
    "username": "testuser",
    "email": "test@example.com", 
    "password": "123456"
}
```

#### ç”¨æˆ·ç™»å½•
```http
POST /api/user/login
Content-Type: application/json

{
    "username": "testuser",
    "password": "123456"
}
```

#### TokenéªŒè¯
```http
POST /api/user/verify
Authorization: Bearer {token}
```

### èŠå¤©è®°å½•æ¥å£

#### è®°å½•èŠå¤©
```http
POST /api/chat/log
Authorization: Bearer {token}
Content-Type: application/json

{
    "question": "ç”¨æˆ·é—®é¢˜",
    "answer": "AIå›ç­”",
    "shareId": "åˆ†äº«ID"
}
```

#### æŸ¥è¯¢èŠå¤©è®°å½•
```http
GET /api/chat/logs?userId=1&page=1&limit=10
Authorization: Bearer {token}
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç«¯å£å†²çª
**é—®é¢˜**: æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæç¤ºç«¯å£è¢«å ç”¨
**è§£å†³**: 
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :3001
netstat -ano | findstr :3002

# ç»ˆæ­¢å ç”¨è¿›ç¨‹ï¼ˆWindowsï¼‰
taskkill /F /PID {è¿›ç¨‹ID}
```

#### 2. FastGPT è¿æ¥å¤±è´¥
**é—®é¢˜**: ä»£ç†æ— æ³•è¿æ¥åˆ° FastGPT
**è§£å†³**:
- ç¡®è®¤ FastGPT åœ¨ http://localhost:3000 æ­£å¸¸è¿è¡Œ
- æ£€æŸ¥ fixed-proxy.js ä¸­çš„ FASTGPT_PORT é…ç½®

#### 3. ç™»å½•é¡µé¢ç©ºç™½
**é—®é¢˜**: è®¿é—®ç™»å½•é¡µé¢æ˜¾ç¤ºç©ºç™½
**è§£å†³**:
- æ£€æŸ¥ simple-server.js æ˜¯å¦æ­£å¸¸è¿è¡Œ
- ç¡®è®¤ login.html æ–‡ä»¶å­˜åœ¨ä¸”è·¯å¾„æ­£ç¡®

#### 4. èŠå¤©è®°å½•ä¸æ˜¾ç¤º
**é—®é¢˜**: ç®¡ç†åå°çœ‹ä¸åˆ°èŠå¤©è®°å½•
**è§£å†³**:
- ç¡®è®¤ç”¨æˆ·å·²é€šè¿‡è®¤è¯ä»£ç†è®¿é—®è¿‡åˆ†äº«é“¾æ¥
- æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯

### è°ƒè¯•æ¨¡å¼

#### å¯ç”¨è¯¦ç»†æ—¥å¿—
åœ¨ fixed-proxy.js ä¸­è®¾ç½®:
```javascript
const DEBUG_MODE = true;
```

#### æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
è®¿é—®æµ‹è¯•é¡µé¢è¿›è¡Œç³»ç»Ÿè¯Šæ–­:
```
http://localhost:3002/è®¤è¯ä»£ç†.html
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

### ç³»ç»Ÿç›‘æ§æŒ‡æ ‡

#### å“åº”æ—¶é—´ç›‘æ§
- ä»£ç†æœåŠ¡å™¨å“åº”æ—¶é—´
- FastGPT åç«¯å“åº”æ—¶é—´
- ç”¨æˆ·è®¤è¯å¤„ç†æ—¶é—´

#### å¹¶å‘å¤„ç†èƒ½åŠ›
- æœ€å¤§å¹¶å‘ç”¨æˆ·æ•°
- ç³»ç»Ÿèµ„æºä½¿ç”¨ç‡
- æ•°æ®åº“è¿æ¥æ± çŠ¶æ€

#### é”™è¯¯ç‡ç»Ÿè®¡
- è®¤è¯å¤±è´¥ç‡
- ä»£ç†é”™è¯¯ç‡
- ç”¨æˆ·ä½“éªŒé—®é¢˜ç‡

## ğŸ” å®‰å…¨å»ºè®®

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **æ›´æ¢é»˜è®¤å¯†ç **
   ```javascript
   // ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
   { id: 1, username: 'admin', email: 'admin@company.com', password: 'å¼ºå¯†ç ' }
   ```

2. **ä½¿ç”¨HTTPS**
   ```javascript
   // åœ¨ fixed-proxy.js ä¸­é…ç½® HTTPS
   const https = require('https');
   const fs = require('fs');
   
   const options = {
       key: fs.readFileSync('path/to/private-key.pem'),
       cert: fs.readFileSync('path/to/certificate.pem')
   };
   ```

3. **æ•°æ®åº“é›†æˆ**
   ```javascript
   // æ›¿æ¢å†…å­˜å­˜å‚¨ä¸ºæ•°æ®åº“
   const mysql = require('mysql2');
   const connection = mysql.createConnection({
       host: 'localhost',
       user: 'root',
       password: 'password',
       database: 'fastgpt_auth'
   });
   ```

4. **JWTå¯†é’¥é…ç½®**
   ```javascript
   // ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨JWTå¯†é’¥
   const JWT_SECRET = process.env.JWT_SECRET || 'your-super-secret-key';
   ```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è·å–å¸®åŠ©
- æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—è·å–é”™è¯¯ä¿¡æ¯
- ä½¿ç”¨æµ‹è¯•é¡µé¢è¯Šæ–­ç³»ç»ŸçŠ¶æ€
- æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ç½‘ç»œå’Œæ§åˆ¶å°é¢æ¿

### ç³»ç»Ÿå‡çº§
- å®šæœŸå¤‡ä»½ç”¨æˆ·æ•°æ®å’ŒèŠå¤©è®°å½•
- æµ‹è¯•æ–°ç‰ˆæœ¬çš„å…¼å®¹æ€§
- é€æ­¥å‡çº§é¿å…æœåŠ¡ä¸­æ–­

---

**é‡è¦æé†’**: é¦–æ¬¡éƒ¨ç½²æ—¶è¯·ä¸¥æ ¼æŒ‰ç…§æ­¥éª¤æ‰§è¡Œï¼Œç¡®ä¿æ¯ä¸ªæœåŠ¡éƒ½æ­£å¸¸å¯åŠ¨åå†è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚
