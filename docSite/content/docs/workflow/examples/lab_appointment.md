---
title: 'å®éªŒå®¤é¢„çº¦'
description: 'å±•ç¤ºé«˜çº§ç¼–æ’æ“ä½œæ•°æ®åº“çš„èƒ½åŠ›'
icon: 'database'
draft: false
toc: true
weight: 141
---

![](/imgs/demo-appointment1.png)

![](/imgs/demo-appointment2.png)

![](/imgs/demo-appointment3.png)

æœ¬ç¤ºä¾‹æ¼”ç¤ºäº†åˆ©ç”¨é—®é¢˜åˆ†ç±»ã€å†…å®¹æå–å’Œ HTTP æ¨¡å—å®ç°æ•°æ®åº“çš„ CRUD æ“ä½œã€‚ä»¥ä¸€ä¸ªå®éªŒå®¤é¢„çº¦ä¸ºä¾‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å¯¹è¯ç³»ç»Ÿé¢„çº¦ã€å–æ¶ˆã€ä¿®æ”¹é¢„çº¦å’ŒæŸ¥è¯¢é¢„çº¦è®°å½•ã€‚

# ç¼–æ’æµç¨‹è§£æ

ç¼–æ’ Tipsï¼š**ä»å·¦å¾€å³ç¼–è¾‘æµç¨‹ï¼›å°½é‡ä¸è¦ä½¿çº¿äº¤å‰**ã€‚

## 1. é—®é¢˜åˆ†ç±»

![](/imgs/demo-appointment4.png)

å¦‚ä¸Šå›¾ï¼Œç”¨æˆ·é—®é¢˜ä½œä¸ºå¯¹è¯çš„èµ·ç‚¹ï¼Œæµå…¥ã€é—®é¢˜åˆ†ç±»æ¨¡å—ã€‘ï¼Œæ ¹æ®ç”¨æˆ·é—®é¢˜çš„å†…å®¹ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯è¯¢é—®å®éªŒå®¤ç›¸å…³é—®é¢˜ã€é¢„çº¦å®éªŒå®¤æˆ–å…¶ä»–é—®é¢˜ã€‚å¦‚æœç”¨æˆ·è¯¢é—®çš„æ˜¯éå®éªŒé—®é¢˜ï¼Œä¼šç›´æ¥æ‹’ç»å›å¤å†…å®¹ã€‚å†æ ¹æ®é—®é¢˜æ˜¯å±äºè¯¢é—®å®éªŒå®¤ç›¸å…³/é¢„çº¦ç±»é—®é¢˜ï¼Œæ‰§è¡Œä¸åŒçš„æµç¨‹ã€‚

{{% alert icon="ğŸ¤—" context="warning" %}}
**Tips:** è¿™é‡Œéœ€è¦å¢åŠ é€‚å½“çš„ä¸Šä¸‹æ–‡ï¼Œæ–¹ä¾¿æ¨¡å‹æ›´å¥½çš„åˆ¤æ–­å±äºå“ªä¸ªç±»åˆ«ã€‚ ä¸è¿‡ç”±äºæ˜¯ä½¿ç”¨äº† GPT-3.5 æ¨¡å‹è¿›è¡Œåˆ¤æ–­ï¼Œæœ‰æ—¶å€™ä¼šæŠ½é£~
{{% /alert %}}

## 2. çŸ¥è¯†åº“æœç´¢

![](/imgs/demo-appointment5.png)

è¿™é‡Œä¸å¤šä»‹ç»ï¼Œæ ‡å‡†çš„èµ°äº†ä¸€å¥—å®éªŒå®¤ä»‹ç»çš„çŸ¥è¯†åº“æœç´¢ã€‚

## 3. å†…å®¹æå–

![](/imgs/demo-appointment6.png)

å†…å®¹æå–æ˜¯ AI å¸¦æ¥é©å‘½æ€§çš„èƒ½åŠ›ï¼Œå¯ä»¥ä»è‡ªç„¶è¯­è¨€ä¸­æå–å‡ºç»“æ„åŒ–çš„æ•°æ®ï¼Œä»è€Œæ–¹ä¾¿è¿›è¡Œé€»è¾‘å¤„ç†ã€‚è¿™é‡Œç”¨äº† 2 ä¸ªæå–æ¨¡å—ï¼Œä¸€ä¸ªç”¨äºæå–å§“åã€æ—¶é—´å’Œå®éªŒå®¤åç§°ï¼›ä¸€ä¸ªç”¨äºæå–é¢„çº¦è¡Œä¸ºã€‚

æå–å§“åã€æ—¶é—´å’Œå®éªŒå®¤åç§°æ—¶å€™ï¼Œéœ€è¦æ³¨æ„æŠŠå¿…å¡«å…³æ‰ï¼Œå¦åˆ™æ¨¡å‹å¯èƒ½ä¼šä¼ªé€ ä¸€äº›å†…å®¹ï¼ŒåŒæ—¶å†å¯¹æ•°æ®å¤„ç†æ—¶å€™ï¼Œéœ€è¦è¿›è¡Œåˆ¤ç©ºå¤„ç†ã€‚

æœ€åå°†ä¸¤ä¸ªæå–çš„ç»“æœï¼Œé€šè¿‡ HTTP æ¨¡å—å‘é€åˆ°åç«¯è¿›è¡Œæ•°æ®åº“çš„æ“ä½œã€‚

## 4. HTTP

HTTP æ¨¡å—å…è®¸ä½ è°ƒç”¨ä»»æ„ POST ç±»å‹çš„ HTTP æ¥å£ï¼Œä»è€Œå®éªŒä¸€äº›å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚è¿™é‡Œæˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ªé¢„çº¦å®éªŒå®¤çš„æ¥å£ï¼Œä¼ å…¥çš„æ˜¯å†…å®¹æå–æ¨¡å—è¾“å‡ºçš„ 2 ä¸ªæå–ç»“æœã€‚

![](/imgs/demo-appointment7.png)

ä»æ—¥å¿—å¯ä»¥çœ‹å‡ºï¼Œæå–çš„å†…å®¹ä¸­åŒ…å«äº† 2 ä¸ª**å­—ç¬¦ä¸²æ•°ç»„**ï¼Œæ³¨æ„æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œä¸€æ¬¡é¢å¤–çš„ parse æ“ä½œæ‰èƒ½æ‹¿åˆ°é‡Œé¢çš„å¯¹è±¡ã€‚å…·ä½“é€»è¾‘å¯ä»¥å‚è€ƒ[é™„ä»¶é‡Œçš„ Laf ä»£ç ](/docs/workflow/examples/lab_appointment/#laf-äº‘å‡½æ•°ä»£ç )ã€‚

å“åº”å€¼ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦è¿”å›ä¸€ä¸ª **JSON å¯¹è±¡**å³å¯ï¼Œæ³¨æ„ï¼Œæ˜¯å¯¹è±¡ï¼Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚

# æ€»ç»“

1. é—®é¢˜åˆ†ç±»å¯ä»¥åœ¨ç®€å•çš„åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œåˆ¤æ–­ç”¨æˆ·çš„é—®é¢˜ç±»å‹ï¼Œä»è€Œå®ç°ä¸åŒçš„è·¯çº¿ã€‚
2. å¯ä»¥é€šè¿‡å†…å®¹æå–æ¨¡å—ï¼Œå®ç°è‡ªç„¶è¯­è¨€è½¬ç»“æ„åŒ–æ•°æ®ï¼Œä»è€Œå®ç°å¤æ‚çš„é€»è¾‘æ“ä½œã€‚
3. å†…å®¹æå– + HTTP æ¨¡å—å…è®¸ä½ æ— é™æ‰©å±•ã€‚

# é™„ä»¶

## ç¼–æ’é…ç½®

å¯ç›´æ¥å¤åˆ¶ï¼Œå¯¼å…¥åˆ° FastGPT ä¸­ã€‚

{{% details title="ç¼–æ’é…ç½®" closed="true" %}}

```json
[
  {
    "moduleId": "userChatInput",
    "name": "ç”¨æˆ·é—®é¢˜(å¯¹è¯å…¥å£)",
    "flowType": "questionInput",
    "position": {
      "x": 309.7143912167367,
      "y": 1501.2761754220846
    },
    "inputs": [
      {
        "key": "userChatInput",
        "type": "systemInput",
        "label": "ç”¨æˆ·é—®é¢˜",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "userChatInput",
        "label": "ç”¨æˆ·é—®é¢˜",
        "type": "source",
        "valueType": "string",
        "targets": [
          {
            "moduleId": "hlw67t",
            "key": "userChatInput"
          }
        ]
      }
    ]
  },
  {
    "moduleId": "history",
    "name": "èŠå¤©è®°å½•",
    "flowType": "historyNode",
    "position": {
      "x": 266.7681439415004,
      "y": 1152.956322172662
    },
    "inputs": [
      {
        "key": "maxContext",
        "type": "numberInput",
        "label": "æœ€é•¿è®°å½•æ•°",
        "value": 16,
        "min": 0,
        "max": 50,
        "connected": true
      },
      {
        "key": "history",
        "type": "hidden",
        "label": "èŠå¤©è®°å½•",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "history",
        "label": "èŠå¤©è®°å½•",
        "valueType": "chat_history",
        "type": "source",
        "targets": [
          {
            "moduleId": "hlw67t",
            "key": "history"
          }
        ]
      }
    ]
  },
  {
    "moduleId": "98xq69",
    "name": "æ–‡æœ¬å†…å®¹æå–",
    "flowType": "contentExtract",
    "showStatus": true,
    "position": {
      "x": 1990.50096174463,
      "y": 1162.2928248187695
    },
    "inputs": [
      {
        "key": "switch",
        "type": "target",
        "label": "è§¦å‘å™¨",
        "valueType": "any",
        "connected": true
      },
      {
        "key": "description",
        "type": "textarea",
        "valueType": "string",
        "value": "ä½ æ˜¯å®éªŒå®¤é¢„çº¦åŠ©æ‰‹ï¼Œä»æ–‡æœ¬ä¸­æå–å‡º: ç”¨æˆ·çš„å§“åã€é¢„çº¦æ—¶é—´å’Œå®éªŒå®¤åç§°ã€‚å½“å‰æ—¶é—´ {{cTime}}",
        "label": "æå–è¦æ±‚æè¿°",
        "description": "å†™ä¸€æ®µæå–è¦æ±‚ï¼Œå‘Šè¯‰ AI éœ€è¦æå–å“ªäº›å†…å®¹",
        "required": true,
        "placeholder": "ä¾‹å¦‚: \n1. ä½ æ˜¯ä¸€ä¸ªå®éªŒå®¤é¢„çº¦åŠ©æ‰‹ã€‚æ ¹æ®ç”¨æˆ·é—®é¢˜ï¼Œæå–å‡ºå§“åã€å®éªŒå®¤å·å’Œé¢„çº¦æ—¶é—´",
        "connected": true
      },
      {
        "key": "history",
        "type": "target",
        "label": "èŠå¤©è®°å½•",
        "valueType": "chat_history",
        "connected": true
      },
      {
        "key": "content",
        "type": "target",
        "label": "éœ€è¦æå–çš„æ–‡æœ¬",
        "required": true,
        "valueType": "string",
        "connected": true
      },
      {
        "key": "extractKeys",
        "type": "custom",
        "label": "ç›®æ ‡å­—æ®µ",
        "description": "ç”± 'æè¿°' å’Œ 'key' ç»„æˆä¸€ä¸ªç›®æ ‡å­—æ®µï¼Œå¯æå–å¤šä¸ªç›®æ ‡å­—æ®µ",
        "value": [
          {
            "desc": "å§“å",
            "key": "name",
            "required": false
          },
          {
            "desc": "æ—¶é—´(YYYY/MM/DD HH:mmæ ¼å¼)",
            "key": "time",
            "required": false
          },
          {
            "desc": "å®éªŒå®¤å",
            "key": "labname",
            "required": false
          }
        ],
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "success",
        "label": "å­—æ®µå®Œå…¨æå–",
        "valueType": "boolean",
        "type": "source",
        "targets": []
      },
      {
        "key": "failed",
        "label": "æå–å­—æ®µç¼ºå¤±",
        "valueType": "boolean",
        "type": "source",
        "targets": []
      },
      {
        "key": "fields",
        "label": "å®Œæ•´æå–ç»“æœ",
        "description": "ä¸€ä¸ª JSON å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š{\"name:\":\"YY\",\"Time\":\"2023/7/2 18:00\"}",
        "valueType": "string",
        "type": "source",
        "targets": [
          {
            "moduleId": "ux0wk1",
            "key": "appointment"
          }
        ]
      },
      {
        "key": "name",
        "label": "æå–ç»“æœ-å§“å",
        "description": "æ— æ³•æå–æ—¶ä¸ä¼šè¿”å›",
        "valueType": "string",
        "type": "source",
        "targets": []
      },
      {
        "key": "time",
        "label": "æå–ç»“æœ-æ—¶é—´(YYYY/MM/DD HH:mmæ ¼å¼)",
        "description": "æ— æ³•æå–æ—¶ä¸ä¼šè¿”å›",
        "valueType": "string",
        "type": "source",
        "targets": []
      },
      {
        "key": "labname",
        "label": "æå–ç»“æœ-å®éªŒå®¤å",
        "description": "æ— æ³•æå–æ—¶ä¸ä¼šè¿”å›",
        "valueType": "string",
        "type": "source",
        "targets": []
      }
    ]
  },
  {
    "moduleId": "ux0wk1",
    "name": "HTTPæ¨¡å—",
    "flowType": "httpRequest",
    "showStatus": true,
    "position": {
      "x": 2708.3795785896,
      "y": 1751.695782003616
    },
    "inputs": [
      {
        "key": "url",
        "value": "",
        "type": "input",
        "label": "è¯·æ±‚åœ°å€",
        "description": "è¯·æ±‚ç›®æ ‡åœ°å€",
        "placeholder": "https://api.fastgpt.run/getInventory",
        "required": true,
        "connected": true
      },
      {
        "key": "switch",
        "type": "target",
        "label": "è§¦å‘å™¨",
        "valueType": "any",
        "connected": false
      },
      {
        "valueType": "string",
        "type": "target",
        "label": "æå–çš„å­—æ®µ",
        "edit": true,
        "key": "appointment",
        "required": true,
        "connected": true
      },
      {
        "valueType": "string",
        "type": "target",
        "label": "é¢„çº¦è¡Œä¸º",
        "edit": true,
        "key": "action",
        "required": true,
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "finish",
        "label": "è¯·æ±‚ç»“æŸ",
        "valueType": "boolean",
        "type": "source",
        "targets": []
      },
      {
        "label": "æå–ç»“æœ",
        "valueType": "string",
        "type": "source",
        "edit": true,
        "targets": [
          {
            "moduleId": "eg5upi",
            "key": "text"
          }
        ],
        "key": "response"
      }
    ]
  },
  {
    "moduleId": "eg5upi",
    "name": "æŒ‡å®šå›å¤",
    "flowType": "answerNode",
    "position": {
      "x": 3437.5642119438417,
      "y": 1941.2730515095657
    },
    "inputs": [
      {
        "key": "switch",
        "type": "target",
        "label": "è§¦å‘å™¨",
        "valueType": "any",
        "connected": false
      },
      {
        "key": "text",
        "type": "textarea",
        "valueType": "string",
        "value": "",
        "label": "å›å¤çš„å†…å®¹",
        "description": "å¯ä»¥ä½¿ç”¨ \\n æ¥å®ç°æ¢è¡Œã€‚ä¹Ÿå¯ä»¥é€šè¿‡å¤–éƒ¨æ¨¡å—è¾“å…¥å®ç°å›å¤ï¼Œå¤–éƒ¨æ¨¡å—è¾“å…¥æ—¶ä¼šè¦†ç›–å½“å‰å¡«å†™çš„å†…å®¹",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "finish",
        "label": "å›å¤ç»“æŸ",
        "description": "å›å¤å®Œæˆåè§¦å‘",
        "valueType": "boolean",
        "type": "source",
        "targets": []
      }
    ]
  },
  {
    "moduleId": "kge59i",
    "name": "ç”¨æˆ·å¼•å¯¼",
    "flowType": "userGuide",
    "position": {
      "x": 278.3025954454602,
      "y": 879.3568006623397
    },
    "inputs": [
      {
        "key": "welcomeText",
        "type": "input",
        "label": "å¼€åœºç™½",
        "value": "ä½ å¥½ï¼Œæˆ‘æ˜¯å®éªŒå®¤åŠ©æ‰‹ï¼Œè¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„ä¹ˆï¼Ÿå¦‚éœ€é¢„çº¦æˆ–ä¿®æ”¹é¢„çº¦å®éªŒå®¤ï¼Œè¯·æä¾›å§“åã€æ—¶é—´å’Œå®éªŒå®¤åç§°ã€‚\n[å®éªŒå®¤ä»‹ç»]\n[å¼€æ”¾æ—¶é—´]\n[é¢„çº¦]",
        "connected": true
      }
    ],
    "outputs": []
  },
  {
    "moduleId": "hlw67t",
    "name": "é—®é¢˜åˆ†ç±»",
    "flowType": "classifyQuestion",
    "showStatus": true,
    "position": {
      "x": 763.6974006305715,
      "y": 1164.1601096928105
    },
    "inputs": [
      {
        "key": "systemPrompt",
        "type": "textarea",
        "valueType": "string",
        "value": "ä½ æ˜¯å®éªŒå®¤åŠ©æ‰‹ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯è¯¢é—®å®éªŒå®¤ç›¸å…³é—®é¢˜ã€é¢„çº¦å®éªŒå®¤æˆ–å…¶ä»–é—®é¢˜",
        "label": "ç³»ç»Ÿæç¤ºè¯",
        "description": "ä½ å¯ä»¥æ·»åŠ ä¸€äº›ç‰¹å®šå†…å®¹çš„ä»‹ç»ï¼Œä»è€Œæ›´å¥½çš„è¯†åˆ«ç”¨æˆ·çš„é—®é¢˜ç±»å‹ã€‚è¿™ä¸ªå†…å®¹é€šå¸¸æ˜¯ç»™æ¨¡å‹ä»‹ç»ä¸€ä¸ªå®ƒä¸çŸ¥é“çš„å†…å®¹ã€‚",
        "placeholder": "ä¾‹å¦‚: \n1. Laf æ˜¯ä¸€ä¸ªäº‘å‡½æ•°å¼€å‘å¹³å°â€¦â€¦\n2. Sealos æ˜¯ä¸€ä¸ªé›†ç¾¤æ“ä½œç³»ç»Ÿ",
        "connected": true
      },
      {
        "key": "history",
        "type": "target",
        "label": "èŠå¤©è®°å½•",
        "valueType": "chat_history",
        "connected": true
      },
      {
        "key": "userChatInput",
        "type": "target",
        "label": "ç”¨æˆ·é—®é¢˜",
        "required": true,
        "valueType": "string",
        "connected": true
      },
      {
        "key": "agents",
        "type": "custom",
        "label": "",
        "value": [
          {
            "value": "å®éªŒå®¤é—®é¢˜",
            "key": "fasw"
          },
          {
            "value": "æ–°å¢ã€å–æ¶ˆã€æŸ¥è¯¢ã€ä¿®æ”¹é¢„çº¦å®éªŒå®¤",
            "key": "fqsw"
          },
          {
            "value": "å…¶ä»–é—®é¢˜",
            "key": "sq32"
          }
        ],
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "fasw",
        "label": "",
        "type": "hidden",
        "targets": [
          {
            "moduleId": "zltb5l",
            "key": "switch"
          }
        ]
      },
      {
        "key": "fqsw",
        "label": "",
        "type": "hidden",
        "targets": [
          {
            "moduleId": "98xq69",
            "key": "switch"
          }
        ]
      },
      {
        "key": "sq32",
        "label": "",
        "type": "hidden",
        "targets": [
          {
            "moduleId": "l5xe4u",
            "key": "switch"
          }
        ]
      },
      {
        "key": "fesw",
        "label": "",
        "type": "hidden",
        "targets": []
      }
    ]
  },
  {
    "moduleId": "l5xe4u",
    "name": "æŒ‡å®šå›å¤",
    "flowType": "answerNode",
    "position": {
      "x": 777.8362177291783,
      "y": 1954.8053341919722
    },
    "inputs": [
      {
        "key": "switch",
        "type": "target",
        "label": "è§¦å‘å™¨",
        "valueType": "any",
        "connected": true
      },
      {
        "key": "text",
        "type": "textarea",
        "valueType": "string",
        "value": "å¯¹ä¸èµ·ï¼Œæˆ‘ä¸å¤ªç†è§£ä½ çš„é—®é¢˜ï¼Œè¯·æ›´è¯¦ç»†æè¿°å…³äºå®éªŒå®¤é—®é¢˜ã€‚",
        "label": "å›å¤çš„å†…å®¹",
        "description": "å¯ä»¥ä½¿ç”¨ \\n æ¥å®ç°æ¢è¡Œã€‚ä¹Ÿå¯ä»¥é€šè¿‡å¤–éƒ¨æ¨¡å—è¾“å…¥å®ç°å›å¤ï¼Œå¤–éƒ¨æ¨¡å—è¾“å…¥æ—¶ä¼šè¦†ç›–å½“å‰å¡«å†™çš„å†…å®¹",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "finish",
        "label": "å›å¤ç»“æŸ",
        "description": "å›å¤å®Œæˆåè§¦å‘",
        "valueType": "boolean",
        "type": "source",
        "targets": []
      }
    ]
  },
  {
    "moduleId": "zltb5l",
    "name": "çŸ¥è¯†åº“æœç´¢",
    "flowType": "kbSearchNode",
    "showStatus": true,
    "position": {
      "x": 1634.995464753433,
      "y": 108.17018849334033
    },
    "inputs": [
      {
        "key": "kbList",
        "type": "custom",
        "label": "å…³è”çš„çŸ¥è¯†åº“",
        "value": [
          {
            "kbId": "64f585865ae84cf2f223e8bd",
            "vectorModel": {
              "model": "text-embedding-ada-002",
              "name": "Embedding-2",
              "price": 0.2,
              "defaultToken": 500,
              "maxToken": 3000
            }
          }
        ],
        "list": [],
        "connected": true
      },
      {
        "key": "similarity",
        "type": "slider",
        "label": "ç›¸ä¼¼åº¦",
        "value": 0.69,
        "min": 0,
        "max": 1,
        "step": 0.01,
        "markList": [
          {
            "label": "100",
            "value": 100
          },
          {
            "label": "1",
            "value": 1
          }
        ],
        "connected": true
      },
      {
        "key": "limit",
        "type": "slider",
        "label": "å•æ¬¡æœç´¢ä¸Šé™",
        "description": "æœ€å¤šå– n æ¡è®°å½•ä½œä¸ºæœ¬æ¬¡é—®é¢˜å¼•ç”¨",
        "value": 2,
        "min": 1,
        "max": 20,
        "step": 1,
        "markList": [
          {
            "label": "1",
            "value": 1
          },
          {
            "label": "20",
            "value": 20
          }
        ],
        "connected": true
      },
      {
        "key": "switch",
        "type": "target",
        "label": "è§¦å‘å™¨",
        "valueType": "any",
        "connected": true
      },
      {
        "key": "userChatInput",
        "type": "target",
        "label": "ç”¨æˆ·é—®é¢˜",
        "required": true,
        "valueType": "string",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "isEmpty",
        "label": "æœç´¢ç»“æœä¸ºç©º",
        "type": "source",
        "valueType": "boolean",
        "targets": []
      },
      {
        "key": "unEmpty",
        "label": "æœç´¢ç»“æœä¸ä¸ºç©º",
        "type": "source",
        "valueType": "boolean",
        "targets": []
      },
      {
        "key": "quoteQA",
        "label": "å¼•ç”¨å†…å®¹",
        "description": "å§‹ç»ˆè¿”å›æ•°ç»„ï¼Œå¦‚æœå¸Œæœ›æœç´¢ç»“æœä¸ºç©ºæ—¶æ‰§è¡Œé¢å¤–æ“ä½œï¼Œéœ€è¦ç”¨åˆ°ä¸Šé¢çš„ä¸¤ä¸ªè¾“å…¥ä»¥åŠç›®æ ‡æ¨¡å—çš„è§¦å‘å™¨",
        "type": "source",
        "valueType": "kb_quote",
        "targets": [
          {
            "moduleId": "bjfklc",
            "key": "quoteQA"
          }
        ]
      }
    ]
  },
  {
    "moduleId": "bjfklc",
    "name": "AI å¯¹è¯",
    "flowType": "chatNode",
    "showStatus": true,
    "position": {
      "x": 2365.8777933722004,
      "y": -8.20949749350251
    },
    "inputs": [
      {
        "key": "model",
        "type": "custom",
        "label": "å¯¹è¯æ¨¡å‹",
        "value": "gpt-3.5-turbo",
        "list": [],
        "connected": true
      },
      {
        "key": "temperature",
        "type": "slider",
        "label": "æ¸©åº¦",
        "value": 0,
        "min": 0,
        "max": 10,
        "step": 1,
        "markList": [
          {
            "label": "ä¸¥è°¨",
            "value": 0
          },
          {
            "label": "å‘æ•£",
            "value": 10
          }
        ],
        "connected": true
      },
      {
        "key": "maxToken",
        "type": "custom",
        "label": "å›å¤ä¸Šé™",
        "value": 550,
        "min": 100,
        "max": 4000,
        "step": 50,
        "markList": [
          {
            "label": "100",
            "value": 100
          },
          {
            "label": "4000",
            "value": 4000
          }
        ],
        "connected": true
      },
      {
        "key": "systemPrompt",
        "type": "textarea",
        "label": "ç³»ç»Ÿæç¤ºè¯",
        "valueType": "string",
        "description": "æ¨¡å‹å›ºå®šçš„å¼•å¯¼è¯ï¼Œé€šè¿‡è°ƒæ•´è¯¥å†…å®¹ï¼Œå¯ä»¥å¼•å¯¼æ¨¡å‹èŠå¤©æ–¹å‘ã€‚è¯¥å†…å®¹ä¼šè¢«å›ºå®šåœ¨ä¸Šä¸‹æ–‡çš„å¼€å¤´ã€‚å¯ä½¿ç”¨å˜é‡ï¼Œä¾‹å¦‚ {{language}}",
        "placeholder": "æ¨¡å‹å›ºå®šçš„å¼•å¯¼è¯ï¼Œé€šè¿‡è°ƒæ•´è¯¥å†…å®¹ï¼Œå¯ä»¥å¼•å¯¼æ¨¡å‹èŠå¤©æ–¹å‘ã€‚è¯¥å†…å®¹ä¼šè¢«å›ºå®šåœ¨ä¸Šä¸‹æ–‡çš„å¼€å¤´ã€‚å¯ä½¿ç”¨å˜é‡ï¼Œä¾‹å¦‚ {{language}}",
        "value": "",
        "connected": true
      },
      {
        "key": "limitPrompt",
        "type": "textarea",
        "valueType": "string",
        "label": "é™å®šè¯",
        "description": "é™å®šæ¨¡å‹å¯¹è¯èŒƒå›´ï¼Œä¼šè¢«æ”¾ç½®åœ¨æœ¬æ¬¡æé—®å‰ï¼Œæ‹¥æœ‰å¼ºå¼•å¯¼å’Œé™å®šæ€§ã€‚å¯ä½¿ç”¨å˜é‡ï¼Œä¾‹å¦‚ {{language}}ã€‚å¼•å¯¼ä¾‹å­:\n1. çŸ¥è¯†åº“æ˜¯å…³äº Laf çš„ä»‹ç»ï¼Œå‚è€ƒçŸ¥è¯†åº“å›ç­”é—®é¢˜ï¼Œä¸ \"Laf\" æ— å…³å†…å®¹ï¼Œç›´æ¥å›å¤: \"æˆ‘ä¸çŸ¥é“\"ã€‚\n2. ä½ ä»…å›ç­”å…³äº \"xxx\" çš„é—®é¢˜ï¼Œå…¶ä»–é—®é¢˜å›å¤: \"xxxx\"",
        "placeholder": "é™å®šæ¨¡å‹å¯¹è¯èŒƒå›´ï¼Œä¼šè¢«æ”¾ç½®åœ¨æœ¬æ¬¡æé—®å‰ï¼Œæ‹¥æœ‰å¼ºå¼•å¯¼å’Œé™å®šæ€§ã€‚å¯ä½¿ç”¨å˜é‡ï¼Œä¾‹å¦‚ {{language}}ã€‚å¼•å¯¼ä¾‹å­:\n1. çŸ¥è¯†åº“æ˜¯å…³äº Laf çš„ä»‹ç»ï¼Œå‚è€ƒçŸ¥è¯†åº“å›ç­”é—®é¢˜ï¼Œä¸ \"Laf\" æ— å…³å†…å®¹ï¼Œç›´æ¥å›å¤: \"æˆ‘ä¸çŸ¥é“\"ã€‚\n2. ä½ ä»…å›ç­”å…³äº \"xxx\" çš„é—®é¢˜ï¼Œå…¶ä»–é—®é¢˜å›å¤: \"xxxx\"",
        "value": "",
        "connected": true
      },
      {
        "key": "switch",
        "type": "target",
        "label": "è§¦å‘å™¨",
        "valueType": "any",
        "connected": false
      },
      {
        "key": "quoteQA",
        "type": "target",
        "label": "å¼•ç”¨å†…å®¹",
        "valueType": "kb_quote",
        "connected": true
      },
      {
        "key": "history",
        "type": "target",
        "label": "èŠå¤©è®°å½•",
        "valueType": "chat_history",
        "connected": true
      },
      {
        "key": "userChatInput",
        "type": "target",
        "label": "ç”¨æˆ·é—®é¢˜",
        "required": true,
        "valueType": "string",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "answerText",
        "label": "æ¨¡å‹å›å¤",
        "description": "å°†åœ¨ stream å›å¤å®Œæ¯•åè§¦å‘",
        "valueType": "string",
        "type": "source",
        "targets": []
      },
      {
        "key": "finish",
        "label": "å›å¤ç»“æŸ",
        "description": "AI å›å¤å®Œæˆåè§¦å‘",
        "valueType": "boolean",
        "type": "source",
        "targets": []
      }
    ]
  },
  {
    "moduleId": "ee1fo3",
    "name": "ç”¨æˆ·é—®é¢˜(å¯¹è¯å…¥å£)",
    "flowType": "questionInput",
    "position": {
      "x": 1133.7087158919899,
      "y": 638.1461154935015
    },
    "inputs": [
      {
        "key": "userChatInput",
        "type": "systemInput",
        "label": "ç”¨æˆ·é—®é¢˜",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "userChatInput",
        "label": "ç”¨æˆ·é—®é¢˜",
        "type": "source",
        "valueType": "string",
        "targets": [
          {
            "moduleId": "zltb5l",
            "key": "userChatInput"
          },
          {
            "moduleId": "bjfklc",
            "key": "userChatInput"
          }
        ]
      }
    ]
  },
  {
    "moduleId": "14dsss",
    "name": "èŠå¤©è®°å½•",
    "flowType": "historyNode",
    "position": {
      "x": 1670.1688237345365,
      "y": 785.0835604459131
    },
    "inputs": [
      {
        "key": "maxContext",
        "type": "numberInput",
        "label": "æœ€é•¿è®°å½•æ•°",
        "value": 6,
        "min": 0,
        "max": 50,
        "connected": true
      },
      {
        "key": "history",
        "type": "hidden",
        "label": "èŠå¤©è®°å½•",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "history",
        "label": "èŠå¤©è®°å½•",
        "valueType": "chat_history",
        "type": "source",
        "targets": [
          {
            "moduleId": "bjfklc",
            "key": "history"
          }
        ]
      }
    ]
  },
  {
    "moduleId": "mhw4md",
    "name": "æ–‡æœ¬å†…å®¹æå–",
    "flowType": "contentExtract",
    "showStatus": true,
    "position": {
      "x": 1955.3493020276055,
      "y": 2135.4407620304137
    },
    "inputs": [
      {
        "key": "switch",
        "type": "target",
        "label": "è§¦å‘å™¨",
        "valueType": "any",
        "connected": false
      },
      {
        "key": "description",
        "type": "textarea",
        "valueType": "string",
        "value": "è¯·æ ¹æ®æˆ‘ä»¬çš„å¯¹è¯ï¼Œåˆ¤æ–­æˆ‘æ˜¯éœ€è¦é¢„çº¦ã€å–æ¶ˆé¢„çº¦è¿˜æ˜¯ä¿®æ”¹é¢„çº¦å®éªŒå®¤ã€‚",
        "label": "æå–è¦æ±‚æè¿°",
        "description": "å†™ä¸€æ®µæå–è¦æ±‚ï¼Œå‘Šè¯‰ AI éœ€è¦æå–å“ªäº›å†…å®¹",
        "required": true,
        "placeholder": "ä¾‹å¦‚: \n1. ä½ æ˜¯ä¸€ä¸ªå®éªŒå®¤é¢„çº¦åŠ©æ‰‹ã€‚æ ¹æ®ç”¨æˆ·é—®é¢˜ï¼Œæå–å‡ºå§“åã€å®éªŒå®¤å·å’Œé¢„çº¦æ—¶é—´",
        "connected": true
      },
      {
        "key": "history",
        "type": "target",
        "label": "èŠå¤©è®°å½•",
        "valueType": "chat_history",
        "connected": true
      },
      {
        "key": "content",
        "type": "target",
        "label": "éœ€è¦æå–çš„æ–‡æœ¬",
        "required": true,
        "valueType": "string",
        "connected": true
      },
      {
        "key": "extractKeys",
        "type": "custom",
        "label": "ç›®æ ‡å­—æ®µ",
        "description": "ç”± 'æè¿°' å’Œ 'key' ç»„æˆä¸€ä¸ªç›®æ ‡å­—æ®µï¼Œå¯æå–å¤šä¸ªç›®æ ‡å­—æ®µ",
        "value": [
          {
            "desc": "é¢„çº¦å®éªŒå®¤",
            "key": "post",
            "required": false
          },
          {
            "desc": "å–æ¶ˆé¢„çº¦",
            "key": "remove",
            "required": false
          },
          {
            "desc": "ä¿®æ”¹é¢„çº¦",
            "key": "put",
            "required": false
          },
          {
            "desc": "æŸ¥è¯¢é¢„çº¦è®°å½•",
            "key": "get",
            "required": false
          }
        ],
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "success",
        "label": "å­—æ®µå®Œå…¨æå–",
        "valueType": "boolean",
        "type": "source",
        "targets": []
      },
      {
        "key": "failed",
        "label": "æå–å­—æ®µç¼ºå¤±",
        "valueType": "boolean",
        "type": "source",
        "targets": []
      },
      {
        "key": "fields",
        "label": "å®Œæ•´æå–ç»“æœ",
        "description": "ä¸€ä¸ª JSON å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š{\"name:\":\"YY\",\"Time\":\"2023/7/2 18:00\"}",
        "valueType": "string",
        "type": "source",
        "targets": [
          {
            "moduleId": "ux0wk1",
            "key": "action"
          }
        ]
      },
      {
        "key": "post",
        "label": "æå–ç»“æœ-é¢„çº¦å®éªŒå®¤",
        "description": "æ— æ³•æå–æ—¶ä¸ä¼šè¿”å›",
        "valueType": "string",
        "type": "source",
        "targets": []
      },
      {
        "key": "put",
        "label": "æå–ç»“æœ-ä¿®æ”¹é¢„çº¦",
        "description": "æ— æ³•æå–æ—¶ä¸ä¼šè¿”å›",
        "valueType": "string",
        "type": "source",
        "targets": []
      },
      {
        "key": "remove",
        "label": "æå–ç»“æœ-å–æ¶ˆé¢„çº¦",
        "description": "æ— æ³•æå–æ—¶ä¸ä¼šè¿”å›",
        "valueType": "string",
        "type": "source",
        "targets": []
      },
      {
        "key": "get",
        "label": "æå–ç»“æœ-æŸ¥è¯¢é¢„çº¦è®°å½•",
        "description": "æ— æ³•æå–æ—¶ä¸ä¼šè¿”å›",
        "valueType": "string",
        "type": "source",
        "targets": []
      }
    ]
  },
  {
    "moduleId": "643ik3",
    "name": "èŠå¤©è®°å½•",
    "flowType": "historyNode",
    "position": {
      "x": 1402.5447731090367,
      "y": 1933.5935888119106
    },
    "inputs": [
      {
        "key": "maxContext",
        "type": "numberInput",
        "label": "æœ€é•¿è®°å½•æ•°",
        "value": 16,
        "min": 0,
        "max": 50,
        "connected": true
      },
      {
        "key": "history",
        "type": "hidden",
        "label": "èŠå¤©è®°å½•",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "history",
        "label": "èŠå¤©è®°å½•",
        "valueType": "chat_history",
        "type": "source",
        "targets": [
          {
            "moduleId": "98xq69",
            "key": "history"
          },
          {
            "moduleId": "mhw4md",
            "key": "history"
          }
        ]
      }
    ]
  },
  {
    "moduleId": "x3ymlc",
    "name": "ç”¨æˆ·é—®é¢˜(å¯¹è¯å…¥å£)",
    "flowType": "questionInput",
    "position": {
      "x": 1457.4894986450388,
      "y": 1763.0754750794902
    },
    "inputs": [
      {
        "key": "userChatInput",
        "type": "systemInput",
        "label": "ç”¨æˆ·é—®é¢˜",
        "connected": true
      }
    ],
    "outputs": [
      {
        "key": "userChatInput",
        "label": "ç”¨æˆ·é—®é¢˜",
        "type": "source",
        "valueType": "string",
        "targets": [
          {
            "moduleId": "98xq69",
            "key": "content"
          },
          {
            "moduleId": "mhw4md",
            "key": "content"
          }
        ]
      }
    ]
  }
]
```

{{% /details %}}

## Laf äº‘å‡½æ•°ä»£ç 

å¯ä»¥åœ¨ [Laf](https://laf.dev/) ä¸­å¿«é€Ÿæ„å»º HTTP æ¥å£ã€‚

{{% details title="å‡½æ•°ä»£ç " closed="true" %}}

```typescript
import cloud from '@lafjs/cloud';
const db = cloud.database();

export default async function (ctx: FunctionContext) {
  try {
    const { appointment, action } = ctx.body;
    console.log(appointment, action);
    const parseBody = JSON.parse(appointment);
    const { get, post, put, remove } = JSON.parse(action);

    if (!!get) {
      return await getRecord(parseBody);
    }
    if (!!post) {
      return await createRecord(parseBody);
    }
    if (!!put) {
      return await putRecord(parseBody);
    }
    if (!!remove) {
      return await removeRecord(parseBody);
    }

    return {
      response: 'å¼‚å¸¸'
    };
  } catch (err) {
    return {
      response: 'å¼‚å¸¸'
    };
  }
}

async function putRecord({ name, time, labname }) {
  const missData = [];
  if (!name) missData.push('ä½ çš„å§“å');

  if (missData.length > 0) {
    return {
      response: `è¯·æä¾›: ${missData.join('ã€')}`
    };
  }

  const { data: record } = await db
    .collection('LabAppointment')
    .where({
      name,
      status: 'unStart'
    })
    .getOne();

  if (!record) {
    return {
      response: `${name} è¿˜æ²¡æœ‰é¢„çº¦è®°å½•`
    };
  }

  const updateWhere = {
    name,
    time: time || record.time,
    labname: labname || record.labname
  };

  await db
    .collection('LabAppointment')
    .where({
      name,
      status: 'unStart'
    })
    .update(updateWhere);

  return {
    response: `ä¿®æ”¹é¢„çº¦æˆåŠŸã€‚
  å§“åï¼š${name}
  æ—¶é—´: ${updateWhere.time}
  å®éªŒå®¤: ${updateWhere.labname}
  `
  };
}

async function getRecord({ name }) {
  if (!name) {
    return {
      response: 'è¯·æä¾›ä½ çš„å§“å'
    };
  }
  const { data } = await db
    .collection('LabAppointment')
    .where({ name, status: 'unStart' })
    .getOne();

  if (!data) {
    return {
      response: `${name} æ²¡æœ‰é¢„çº¦ä¸­çš„è®°å½•`
    };
  }
  return {
    response: `${name} æœ‰ä¸€æ¡é¢„çº¦è®°å½•ï¼š
å§“åï¼š${data.name}
æ—¶é—´: ${data.time}
å®éªŒå®¤: ${data.labname}
    `
  };
}

async function removeRecord({ name }) {
  if (!name) {
    return {
      response: 'è¯·æä¾›ä½ çš„å§“å'
    };
  }
  const { deleted } = await db
    .collection('LabAppointment')
    .where({ name, status: 'unStart' })
    .remove();

  if (deleted > 0) {
    return {
      response: `å–æ¶ˆé¢„çº¦è®°å½•æˆåŠŸ: ${name}`
    };
  }
  return {
    response: ` ${name} æ²¡æœ‰é¢„çº¦ä¸­çš„è®°å½•`
  };
}

async function createRecord({ name, time, labname }) {
  const missData = [];
  if (!name) missData.push('ä½ çš„å§“å');
  if (!time) missData.push('éœ€è¦é¢„çº¦çš„æ—¶é—´');
  if (!labname) missData.push('å®éªŒå®¤åç§°');

  if (missData.length > 0) {
    return {
      response: `è¯·æä¾›: ${missData.join('ã€')}`
    };
  }

  const { data: record } = await db
    .collection('LabAppointment')
    .where({
      name,
      status: 'unStart'
    })
    .getOne();

  if (record) {
    return {
      response: `æ‚¨å·²ç»æœ‰ä¸€ä¸ªé¢„çº¦è®°å½•äº†:
å§“åï¼š${record.name}
æ—¶é—´: ${record.time}
å®éªŒå®¤: ${record.labname}

æ¯äººä»…èƒ½åŒæ—¶é¢„çº¦ä¸€ä¸ªå®éªŒå®¤ã€‚
      `
    };
  }

  await db.collection('LabAppointment').add({
    name,
    time,
    labname,
    status: 'unStart'
  });

  return {
    response: `é¢„çº¦æˆåŠŸã€‚
å§“åï¼š${name}
æ—¶é—´: ${time}
å®éªŒå®¤: ${labname}
  `
  };
}
```

{{% /details %}}
